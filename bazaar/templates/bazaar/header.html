{% extends "header.html" %}

{% block offcanvas_header %}
    <h5 class="offcanvas-title" id="offcanvasNavbarLabel">Bazaar</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
{% endblock %}

{% block offcanvas_body %}
    <form class="d-flex" role="search" action="{% url "bazaar:ad_list" %}" method="get">
        {{ simple_search_form.query }}
        <button class="btn btn-outline-success">Search</button>
    </form>
    <ul class="navbar-nav">
        {% with user_permissions=user.get_all_permissions %}
            {% if user.is_superuser or 'bazaar.view_category' in user_permissions %}
                <li class="nav-item">
                    <a class="nav-link" href="{% url "bazaar:category_list" %}">Categories</a>
                </li>                
            {% endif %}
            {% if user.is_superuser or 'bazaar.view_currency' in user_permissions%}
                <li class="nav-item">
                    <a class="nav-link" href="{% url "bazaar:currency_list" %}">Currencies</a>
                </li>
            {% endif %}
            {% if user.is_superuser or 'bazaar.view_report' in user_permissions%}
                <li class="nav-item">
                    <a class="nav-link" href="{% url "bazaar:report_list" %}">Reports</a>
                </li>
            {% endif %}
            {% if user.is_superuser or 'bazaar.view_users' in user_permissions%}
                <li class="nav-item">
                    <a class="nav-link" target="_blank" href="{% url "user_list" %}">Users</a>
                </li>
            {% endif %}
        {% endwith %}

        {% if user.is_authenticated %}
            <li class="nav-item">
                <a class="nav-link" href="{% url "bazaar:ad_create" %}">New Ad</a>
            </li>            
            <li class="nav-item">
                <a class="nav-link" href="{% url "bazaar:profile_detail" %}">Profile</a>
            </li>
            <li class="nav-item">
                <form action="{% url "logout" %}?next={{ request.path }}" method="post">
                    {% csrf_token %}
                    <input class="nav-link" type="submit" value="Logout">
                </form>
            </li>
        {% else %}
            <li class="nav-item">
                <a class="nav-link" href="{% url "login" %}?next={{ request.path }}">Login</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="{% url "register" %}">Register</a>
            </li>
        {% endif %}
    </ul>
{% endblock %}